"use strict";angular.module("app",["ngSanitize","toastr","ngAnimate","ngMessages","ui.router","ui.bootstrap","angular-loading-bar","app.home","app.detail","app.common"]),angular.module("app.home",[]),angular.module("app.detail",[]),angular.module("app.common",[]),angular.module("app.common").constant("constant",{noValue:"N/A",IMDBMaxRate:10,sortType:{title:"Title",year:"Year"}}),angular.module("app.common").factory("dataService",["$http","$q","toastr","$log","$location",function(r,e,t,o,a){function n(r){return u.invoke(s,{s:r.title,y:r.year,page:r.page,r:"json"})}function l(r){return u.invoke(s,{i:r,plot:"full",r:"json"})}function i(a,n){var l=e.defer();return r.get(s,{params:n}).then(function(r){r.data&&"False"===r.data.Response?(t.error(r.data.Error,"Error"),o.error(r.data.Error),l.reject(r.data.Error)):l.resolve(r.data)},function(r){t.error("server error","Error"),o.error(r),l.reject("server error")}),l.promise}var s=a.protocol()+"://www.omdbapi.com/",u={search:n,detail:l,invoke:i};return u}]),angular.module("app.common").filter("wordsLimit",function(){return function(r,e){if(r){var t=r.trim().split(" ");return t.length<e?r:(t=r.trim().split(" ",e),r=t.join(" "))}}}),angular.module("app.common").directive("myLoading",function(){return{restrict:"AE",template:'<div class="loading"><div class="double-bounce1"></div><div class="double-bounce2"></div></div>'}}),angular.module("app").config(["$urlRouterProvider","$stateProvider",function(r,e){r.otherwise("/"),e.state("home",{url:"/",templateUrl:"scripts/home/home.html",controller:"HomeController",controllerAs:"vm"}).state("detail",{url:"/detail/:id",templateUrl:"scripts/detail/detail.html",controller:"DetailController",controllerAs:"vm",resolve:{movie:["$stateParams","dataService",function(r,e){return e.detail(r.id).then(function(r){return r})}]}})}]),angular.module("app.home").controller("HomeController",["dataService","constant",function(r,e){function t(e){n.loading=!0,e&&(n.criteria.page=1),r.search(n.criteria).then(function(r){n.results=r.Search,n.totalResults=r.totalResults,n.loading=!1})}function o(){n.criteria.title=null,n.criteria.year=null,n.criteria.page=1,n.results=void 0,n.sortColumn=void 0,n.reverse=!0,n.searchForm&&n.searchForm.$setPristine(),n.loading=!1}function a(r){n.reverse=n.sortColumn===r&&!n.reverse,n.sortColumn=r}var n=this;n.criteria={title:null,year:null,page:1},n.results=void 0,n.sortColumn=void 0,n.reverse=!0,n.constant=e,n.maxSize=5,n.search=t,n.reset=o,n.sortBy=a}]),angular.module("app.detail").controller("DetailController",["movie","constant",function(r,e){function t(){o.showFullPlot=!0}var o=this;o.movie=r,o.constant=e,o.showFullPlot=!1,o.showMore=t,o.star={model:r.imdbRating===e.noValue?e.noValue:r.imdbRating/2,maxRate:e.IMDBMaxRate/2}}]);